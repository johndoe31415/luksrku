#!/bin/sh
#
# Copyright 2016-2017 Johannes Bauer <joe@johannes-bauer.com>
# Released under GPLv3

PREREQ="lvm2"

#
# Standard initramfs preamble
#
prereqs()
{
	echo "$PREREQ"
}

case $1 in
	prereqs)
		prereqs
		exit 0
		;;
esac

. /scripts/functions

if [ ! -f /etc/luksrku-server.bin ]; then
	exit 0
fi

configure_networking
/sbin/luksrku --server-mode -v -k /etc/luksrku-server.bin

exit 0
